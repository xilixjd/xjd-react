{"version":3,"sources":["src/react-dom/dom.js","src/react-dom/diff.js","src/react/setStateQueue.js","src/react/component.js","src/react/createElement.js","src/react/index.js","src/react-dom/render.js","src/react-dom/index.js","src/index.js"],"names":["setAttribute","dom","name","value","test","toLowerCase","cssKey","cssAttr","style","removeAttribute","diff","renderComponent","removeNode","node","parentNode","removeChild","unmountComponent","component","componentWillUnmount","base","createComponentInst","props","inst","prototype","render","Component","constructor","vnode","container","newDom","diffNode","appendChild","out","undefined","String","nodeType","textContent","document","createTextNode","replaceChild","tag","diffComponent","isSameNodeType","createElement","childNodes","map","children","length","diffChildren","diffAttributes","nodeName","_component","vchildren","console","log","domChildren","keyed","i","child","key","push","min","childrenLen","vchild","j","c","f","nextSibling","insertBefore","domComp","setComponentProps","attrs","componentWillMount","componentWillReceiveProps","rendered","componentWillUpdate","componentDidUpdate","componentDidMount","old","attributes","oldAttr","enqueueSetState","setStateQueue","renderQueue","defer","fn","Promise","resolve","then","state","flush","some","item","shift","prevState","Object","assign","isReactComponent","stateChange","_render","textNode","attrsKeys","keys","forEach","Welcome","Counter","num","flag","setState","onClick","React","ReactDOM","getElementById"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"src.957af6c9.map","sourceRoot":"..","sourcesContent":["export default function setAttribute(dom, name, value) {\n    if (name === \"className\") {\n        name = \"class\";\n    }\n\n    if (/^on\\w+/.test(name)) {\n        if (typeof value === \"function\") {\n            name = name.toLowerCase();\n            dom[name] = value;\n        } else {\n            throw \"事件绑定必须为函数\";\n        }\n    } else if (name === \"style\") {\n        if (value && typeof value === \"object\") {\n            for (let cssKey in value) {\n                let cssAttr = value[cssKey];\n                dom.style[cssKey] = typeof cssAttr === \"number\" ? cssAttr + \"px\" : cssAttr;\n            }\n        }\n    } else {\n        if (!typeof value === \"string\") {\n            throw \"属性必须为string类型\";\n        }\n        if (name in dom) {\n            dom[name] = value || \"\";\n            return;\n        }\n        if (value) {\n            dom.setAttribute(name, value);\n        } else {\n            dom.removeAttribute(name, value);\n        }\n    }\n}","import Component from '../react/component';\nimport setAttribute from './dom';\n\nfunction removeNode(node) {\n    if (node && node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\n\nfunction unmountComponent(component) {\n    if (component.componentWillUnmount) {\n        component.componentWillUnmount();\n    }\n    removeNode(component.base);\n}\n\nfunction createComponentInst(component, props) {\n    let inst;\n    if (component.prototype && component.prototype.render) {\n        inst = new component(props);\n    } else {\n        inst = new Component(props);\n        inst.constructor = component;\n        inst.render = function() {\n            // 不同\n            return inst.constructor(props);\n        }\n    }\n    return inst;\n}\n\nexport function diff(dom, vnode, container) {\n    const newDom = diffNode(dom, vnode);\n    // newDom.parentNode !== container 这个是否有必要？\n    if (container && newDom.parentNode !== container) {\n        container.appendChild(newDom);\n    }\n\n    // 这个是否有必要？\n    // return newDom;\n}\n\nfunction diffNode(dom, vnode) {\n    let out = dom;\n\n    if (vnode === undefined || vnode === null || typeof vnode === \"boolean\") {\n        vnode = \"\";\n    }\n\n    if (typeof vnode === \"number\") {\n        vnode = String(vnode);\n    }\n\n    if (typeof vnode === \"string\") {\n        if (dom && dom.nodeType === 3) {\n            if (dom.textContent !== vnode) {\n                dom.textContent = vnode;\n            }\n        } else {\n            out = document.createTextNode(vnode);\n            if (dom && dom.parentNode) {\n                dom.parentNode.replaceChild(out, dom);\n            }\n        }\n        return out;\n    }\n\n    if (typeof vnode.tag === \"function\") {\n        return diffComponent(dom, vnode);\n    }\n\n    if (!dom || !isSameNodeType(dom, vnode)) {\n        out = document.createElement(vnode.tag);\n        if (dom) {\n            [...dom.childNodes].map(out.appendChild);\n            if (dom.parentNode) {\n                dom.parentNode.replaceChild(out, dom);\n            }\n        }\n    }\n\n    if (vnode.children && vnode.children.length > 0 || out.childNodes && out.childNodes.length > 0) {\n        diffChildren(out, vnode.children);\n    }\n\n    // out 没法解决，因为 dom 为 undefined\n    diffAttributes(out, vnode);\n\n    return out;\n}\n\n\nfunction isSameNodeType(dom, vnode) {\n    if (typeof vnode === \"string\" || typeof vnode === \"number\") {\n        return dom && dom.nodeType === 3;\n    } else if (typeof vnode.tag === \"string\") {\n        return dom && dom.nodeName.toLowerCase() === vnode.tag.toLowerCase();\n    } else {\n        return dom && dom._component && dom._component.constructor === vnode.tag;\n    }\n}\n\nfunction diffChildren( dom, vchildren ) {\n    console.log(dom, vchildren)\n\n    const domChildren = dom.childNodes;\n    const children = [];\n\n    const keyed = {};\n\n    if ( domChildren.length > 0 ) {\n        for ( let i = 0; i < domChildren.length; i++ ) {\n            const child = domChildren[ i ];\n            const key = child.key;\n            if ( key ) {\n                keyed[ key ] = child;\n            } else {\n                children.push( child );\n            }\n        }\n    }\n\n    if ( vchildren && vchildren.length > 0 ) {\n\n        let min = 0;\n        let childrenLen = children.length;\n\n        for ( let i = 0; i < vchildren.length; i++ ) {\n\n            const vchild = vchildren[ i ];\n            const key = vchild.key;\n            let child;\n            if (vchild.tag === \"h1\") {\n                // debugger\n            }\n\n            if ( key ) {\n\n                if ( keyed[ key ] ) {\n                    child = keyed[ key ];\n                    keyed[ key ] = undefined;\n                }\n\n            } else if ( min < childrenLen ) {\n\n                for ( let j = min; j < childrenLen; j++ ) {\n\n                    let c = children[ j ];\n\n                    if ( c && isSameNodeType( c, vchild ) ) {\n\n                        child = c;\n                        children[ j ] = undefined;\n\n                        if ( j === childrenLen - 1 ) childrenLen--;\n                        if ( j === min ) min++;\n                        break;\n\n                    }\n\n                }\n\n            }\n            console.log(child, vchild)\n\n            child = diffNode( child, vchild );\n\n            const f = domChildren[ i ];\n            if ( child && child !== dom && child !== f ) {\n                if ( !f ) {\n                    console.log(\"appendChild\", child, vchild)\n                    dom.appendChild(child);\n                } else if ( child === f.nextSibling ) {\n                    console.log(\"remove\", f)\n                    removeNode( f );\n                } else {\n                    console.log(\"insertbefore\", child)\n                    dom.insertBefore( child, f );\n                }\n            }\n\n        }\n    }\n}\n\nfunction diffComponent(dom, vnode) {\n    let domComp = dom && dom._component;\n    let newDom;\n\n    if (domComp && domComp.constructor === vnode.tag) {\n        setComponentProps(domComp, vnode.attrs);\n        renderComponent(domComp);\n        newDom = domComp.base;\n    } else {\n        if (domComp) {\n            // dom 存在 component（该节点为 component 节点）\n            unmountComponent(domComp);\n        }\n        domComp = createComponentInst(vnode.tag, vnode.attrs);\n        setComponentProps(domComp, vnode.attrs);\n        renderComponent(domComp);\n\n        newDom = domComp.base;\n        if (dom && dom._component) {\n            dom._component = null;\n        }\n        if (dom && newDom !== dom) {\n            removeNode(dom);\n        }\n    }\n\n    return newDom;\n}\n\nfunction setComponentProps(component, props) {\n    if (!component.base) {\n        if (component.componentWillMount) {\n            component.componentWillMount();\n        }\n    } else {\n        if (component.componentWillReceiveProps) {\n            component.componentWillReceiveProps();\n        }\n    }\n\n    component.props = props;\n}\n\nexport function renderComponent(component) {\n    let base;\n    const rendered = component.render();\n\n    if (component.base && component.componentWillUpdate) {\n        component.componentWillUpdate();\n    }\n\n    base = diffNode(component.base, rendered);\n\n    if (component.base) {\n        if (component.componentDidUpdate) {\n            component.componentDidUpdate();\n        }\n    } else {\n        if (component.componentDidMount) {\n            component.componentDidMount();\n        }\n    }\n\n    component.base = base;\n    base._component = component;\n}\n\nfunction diffAttributes(dom, vnode) {\n    const old = {};\n    const attrs = vnode.attrs;\n\n    for (let i = 0; i < dom.attributes.length; i++) {\n        const oldAttr = dom.attributes[i];\n        old[oldAttr.name] = oldAttr.value;\n    }\n\n    for (let key in old) {\n        if (!(name in attrs)) {\n            setAttribute(dom, key, undefined);\n        }\n    }\n\n    for (let key in attrs) {\n        setAttribute(dom, key, attrs[key]);\n    }\n}","import { renderComponent } from '../react-dom/diff';\n\nconst setStateQueue = [];\nconst renderQueue = [];\n\nfunction defer(fn) {\n    return Promise.resolve().then(fn);\n}\n\nexport function enqueueSetState(state, component) {\n    if (setStateQueue.length === 0) {\n        defer(flush);\n    }\n\n    setStateQueue.push({\n        state,\n        component,\n    })\n\n    if (!renderQueue.some(item => item === component)) {\n        renderQueue.push(component);\n    }\n}\n\nfunction flush() {\n    let item, component;\n    while (item = setStateQueue.shift()) {\n        const { state, component } = item;\n        if (!component.prevState) {\n            component.prevState = Object.assign( {}, component.state );\n        }\n        if (typeof state === \"function\") {\n            Object.assign(component.state, state(component.prevState));\n        } else {\n            Object.assign(component.state, state);\n        }\n        component.prevState = component.state;\n    }\n\n    while (component = renderQueue.shift()) {\n        renderComponent(component);\n    }\n}","// import ReactDOM from '../react-dom';\nimport { enqueueSetState } from './setStateQueue';\n\nclass Component {\n    constructor(props = {}) {\n        this.isReactComponent = true;\n\n        this.state = {};\n        this.props = props;\n    }\n\n    setState(stateChange) {\n        // Object.assign(this.state, stateChange);\n        // ReactDOM.renderComponent(this);\n        enqueueSetState(stateChange, this);\n    }\n}\n\nexport default Component;","\n\nfunction createElement(tag, attrs, ...children) {\n    attrs = attrs || {};\n    \n    return {\n        tag,\n        attrs,\n        children,\n        key: attrs.key || null,\n    }\n}\n\nexport default createElement;","import Component from './component'\nimport createElement from './createElement'\n\nexport default {\n    Component,\n    createElement,\n}","import Component from '../react/component';\nimport setAttribute from './dom';\n\nimport { diff } from './diff';\n\nfunction removeNode(node) {\n    if (node && node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\n\nfunction unmountComponent(component) {\n    if (component.componentWillUnmount) {\n        component.componentWillUnmount();\n    }\n    removeNode(component.base);\n}\n\nfunction createComponentInst(component, props) {\n    let inst;\n    if (component.prototype && component.prototype.render) {\n        inst = new component(props);\n    } else {\n        inst = new Component(props);\n        inst.constructor = component;\n        inst.render = function() {\n            // 不同\n            return inst.constructor(props);\n        }\n    }\n    return inst;\n}\n\nfunction setComponentProps(component, props) {\n    if (!component.base) {\n        if (component.componentWillMount) {\n            component.componentWillMount();\n        }\n    } else {\n        if (component.componentWillReceiveProps) {\n            component.componentWillReceiveProps(props);\n        }\n    }\n    component.props = props;\n}\n\nexport function renderComponent(component) {\n    let base;\n\n    const rendered = component.render();\n\n    if (component.base && component.componentWillUpdate) {\n        component.componentWillUpdate();\n    }\n\n    base = _render(rendered);\n\n    if (component.base) {\n        if (component.componentDidUpdate) {\n            component.componentDidUpdate();\n        }\n    } else {\n        if (component.componentDidMount) {\n            component.componentDidMount();\n        }\n    }\n\n    if (component.base && component.base.parentNode) {\n        component.base.parentNode.replaceChild(base, component.base);\n    }\n\n    component.base = base;\n    base._component = component;\n}\n\nfunction _render(vnode) {\n    if (vnode === undefined || vnode === null || typeof vnode === \"boolean\") {\n        vnode = \"\";\n    }\n\n    if (typeof vnode === \"number\") {\n        vnode = String(vnode);\n    }\n\n    if (typeof vnode === \"string\") {\n        let textNode = document.createTextNode(vnode);\n        return textNode;\n    }\n\n    if (typeof vnode.tag === \"function\") {\n        let component = createComponentInst(vnode.tag, vnode.attrs);\n        setComponentProps(component, vnode.attrs);\n        renderComponent(component);\n        return component.base;\n    }\n\n    // 虚拟 dom 节点\n    const dom = document.createElement(vnode.tag);\n\n    if (vnode.attrs) {\n        let attrsKeys = Object.keys(vnode.attrs);\n        attrsKeys.forEach(key => {\n            let value = vnode.attrs[key];\n            setAttribute(dom, key, value);\n        });\n    }\n\n    if (vnode.children) {\n        vnode.children.forEach(child => {\n            render(child, dom);\n        })\n    }\n\n    return dom;\n}\n\n// export function render(vnode, container) {\n//     return container.appendChild(_render(vnode));\n// }\n\nexport default function render(vnode, container, dom) {\n    diff(dom, vnode, container);\n}","import render from './render';\nimport { renderComponent } from './diff';\n\nexport default {\n    render,\n    renderComponent,\n}","import React from './react';\nimport ReactDOM from './react-dom';\n\n\nfunction Welcome() {\n    return (\n        <h2>welcom</h2>\n    )\n}\n\nclass Counter extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            num: 1,\n            flag: true,\n        }\n    }\n\n    onClick() {\n        let flag = this.state.flag;\n        this.setState({ num: this.state.num + 1, flag: !flag });\n        this.setState({ num: this.state.num + 1, flag: !flag });\n    }\n\n    render() {\n        let flag = this.state.flag;\n        return (\n            <div>\n                {flag ? <Welcome /> : <h1>flag: false</h1>}\n                {/* {flag ? <h1>flag: true</h1> : <h1>flag: false</h1>} */}\n                {/* <h2>{this.props.a}</h2> */}\n                {/* <h1>count: {this.state.num}</h1> */}\n                <button onClick={() => this.onClick()}>add</button>\n            </div>\n        );\n    }\n}\n\nReactDOM.render(\n    <Counter a={1}/>,\n    document.getElementById(\"root\")\n);"]}